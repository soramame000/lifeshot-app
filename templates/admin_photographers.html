{% extends "admin_base.html" %}
{% block title %}カメラマン管理 - NAGORI{% endblock %}
{% block page_title %}カメラマン管理{% endblock %}

{% block content %}
<p class="text-muted mb-3">{{ photographers|length }}名のカメラマンが登録しています</p>

{% if photographers %}
<div class="card">
  <div class="table-container">
    <table class="table">
      <thead>
        <tr>
          <th>カメラマン</th>
          <th>メールアドレス</th>
          <th>登録日</th>
          <th>イベント数</th>
          <th class="text-right">累計売上</th>
          <th>ステータス</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for p in photographers %}
        <tr>
          <td>
            <strong>{{ p.name }}</strong>
          </td>
          <td class="text-muted">{{ p.email }}</td>
          <td class="text-muted">{{ p.created_at.strftime('%Y/%m/%d') }}</td>
          <td>{{ p.events|length }}件</td>
          <td class="text-right">¥{{ "{:,}".format(p.total_sales) }}</td>
          <td>
            {% if p.status == 'active' %}
              <span class="badge badge-success">アクティブ</span>
            {% else %}
              <span class="badge badge-danger">停止中</span>
            {% endif %}
          </td>
          <td class="text-right">
            <form method="POST" action="{{ url_for('admin_photographer_toggle', photographer_id=p.id) }}" style="display: inline;">
              {% if p.status == 'active' %}
                <button type="submit" class="btn btn-outline btn-sm" onclick="return confirm('このカメラマンを停止しますか？')">
                  停止
                </button>
              {% else %}
                <button type="submit" class="btn btn-outline btn-sm">
                  有効化
                </button>
              {% endif %}
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% else %}
<div class="card">
  <div class="card-body">
    <p class="text-muted text-center">まだカメラマンが登録していません</p>
  </div>
</div>
{% endif %}
{% endblock %}

