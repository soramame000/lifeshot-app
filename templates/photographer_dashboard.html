{% extends "photographer_base.html" %}
{% block title %}ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - LifeShot{% endblock %}
{% block page_title %}ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰{% endblock %}

{% block content %}
<div class="stats-grid">
  <div class="stat-card">
    <div class="stat-label">ä»Šæœˆã®å£²ä¸Š</div>
    <div class="stat-value">Â¥{{ "{:,}".format(monthly_sales) }}</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">ç´¯è¨ˆå£²ä¸Š</div>
    <div class="stat-value">Â¥{{ "{:,}".format(total_sales) }}</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">ç´¯è¨ˆæ³¨æ–‡æ•°</div>
    <div class="stat-value">{{ total_orders }}</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">å…¬é–‹ä¸­ã®å†™çœŸ</div>
    <div class="stat-value">{{ total_photos }}</div>
  </div>
</div>

<div class="grid-2">
  <div class="card">
    <div class="card-header">
      <h3 class="card-title">ğŸ“… ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§</h3>
      <a href="{{ url_for('photographer_event_new') }}" class="btn btn-primary btn-sm">+ æ–°è¦ä½œæˆ</a>
    </div>
    <div class="card-body">
      {% if events %}
        <div class="table-container">
          <table class="table">
            <thead>
              <tr>
                <th>ã‚¤ãƒ™ãƒ³ãƒˆå</th>
                <th>æ—¥ä»˜</th>
                <th>å†™çœŸæ•°</th>
                <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
              </tr>
            </thead>
            <tbody>
              {% for event in events[:5] %}
              <tr>
                <td>
                  <a href="{{ url_for('photographer_event_detail', event_id=event.id) }}" style="color: var(--light); text-decoration: none;">
                    {{ event.title }}
                  </a>
                </td>
                <td class="text-muted">{{ event.event_date.strftime('%Y/%m/%d') if event.event_date else '-' }}</td>
                <td>{{ event.photos|length }}æš</td>
                <td>
                  {% if event.status == 'published' %}
                    <span class="badge badge-success">å…¬é–‹ä¸­</span>
                  {% elif event.status == 'closed' %}
                    <span class="badge badge-gray">çµ‚äº†</span>
                  {% else %}
                    <span class="badge badge-warning">ä¸‹æ›¸ã</span>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% if events|length > 5 %}
        <div class="mt-2 text-right">
          <a href="{{ url_for('photographer_events') }}" class="btn btn-outline btn-sm">ã™ã¹ã¦è¦‹ã‚‹ â†’</a>
        </div>
        {% endif %}
      {% else %}
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ“…</div>
          <h4 class="empty-state-title">ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“</h4>
          <p class="empty-state-desc">æœ€åˆã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã—ã‚‡ã†</p>
          <a href="{{ url_for('photographer_event_new') }}" class="btn btn-primary">ã‚¤ãƒ™ãƒ³ãƒˆã‚’ä½œæˆ</a>
        </div>
      {% endif %}
    </div>
  </div>
  
  <div class="card">
    <div class="card-header">
      <h3 class="card-title">ğŸ’° æœ€è¿‘ã®å£²ä¸Š</h3>
      <a href="{{ url_for('photographer_sales') }}" class="btn btn-outline btn-sm">è©³ç´°ã‚’è¦‹ã‚‹</a>
    </div>
    <div class="card-body">
      {% if recent_orders %}
        <div class="table-container">
          <table class="table">
            <thead>
              <tr>
                <th>æ—¥æ™‚</th>
                <th>è³¼å…¥è€…</th>
                <th>æšæ•°</th>
                <th class="text-right">é‡‘é¡</th>
              </tr>
            </thead>
            <tbody>
              {% for order in recent_orders %}
              <tr>
                <td class="text-muted">{{ order.created_at.strftime('%m/%d %H:%M') }}</td>
                <td>{{ order.buyer_name }}</td>
                <td>{{ order.items|length }}æš</td>
                <td class="text-right">Â¥{{ "{:,}".format(order.photographer_amount) }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ’°</div>
          <h4 class="empty-state-title">ã¾ã å£²ä¸ŠãŒã‚ã‚Šã¾ã›ã‚“</h4>
          <p class="empty-state-desc">å†™çœŸãŒå£²ã‚Œã‚‹ã¨ã€ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</p>
        </div>
      {% endif %}
    </div>
  </div>
</div>

<style>
  .grid-2 {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 1.5rem;
  }
  
  @media (max-width: 900px) {
    .grid-2 {
      grid-template-columns: 1fr;
    }
  }
</style>
{% endblock %}

